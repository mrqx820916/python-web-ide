import{d as e,_ as a,r as t,c as l,a as o,w as s,b as r,o as u,e as n,f as d,g as i,u as c,E as m}from"./index-BZ1CGDjA.js";import{s as p}from"./request-28qKeUKR.js";const f=e("user",{state:()=>({token:localStorage.getItem("token")||"",userInfo:null}),actions:{async login(e){try{const a=await function(e){return p({url:"/user/login",method:"post",data:e})}(e);return this.token=a.token,this.userInfo=a.user,localStorage.setItem("token",a.token),a}catch(a){throw a}},async getUserInfo(){try{const e=await p({url:"/user/info",method:"get"});return this.userInfo=e,e}catch(e){throw e}},async logout(){try{await p({url:"/user/logout",method:"post"}),this.token="",this.userInfo=null,localStorage.removeItem("token")}catch(e){throw e}}}}),g={class:"login-container"},h=a({__name:"index",setup(e){const a=c(),p=f(),h=t(null),w=t(!1),v=t({username:"",password:""}),y={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},_=async()=>{if(h.value)try{await h.value.validate(),w.value=!0;await p.login(v.value);m.success("登录成功"),a.push("/")}catch(e){m.error(e.message||"登录失败")}finally{w.value=!1}};return(e,a)=>{const t=r("el-input"),c=r("el-form-item"),m=r("el-button"),p=r("el-form"),f=r("el-card");return u(),l("div",g,[o(f,{class:"login-card"},{header:s((()=>a[2]||(a[2]=[n("h2",{class:"login-title"},"Python Web IDE",-1)]))),default:s((()=>[o(p,{ref_key:"formRef",ref:h,model:v.value,rules:y,"label-width":"80px"},{default:s((()=>[o(c,{label:"用户名",prop:"username"},{default:s((()=>[o(t,{modelValue:v.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),o(c,{label:"密码",prop:"password"},{default:s((()=>[o(t,{modelValue:v.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value.password=e),type:"password",placeholder:"请输入密码",onKeyup:d(_,["enter"])},null,8,["modelValue"])])),_:1}),o(c,null,{default:s((()=>[o(m,{type:"primary",loading:w.value,onClick:_},{default:s((()=>a[3]||(a[3]=[i(" 登录 ")]))),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])),_:1})])}}},[["__scopeId","data-v-a543fccf"]]);export{h as default};
